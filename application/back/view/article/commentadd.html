<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>添加评论</title>
	<meta name="renderer" content="webkit">	
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">	
	<meta name="apple-mobile-web-app-status-bar-style" content="black">	
	<meta name="apple-mobile-web-app-capable" content="yes">	
	<meta name="format-detection" content="telephone=no">	
	<link rel="stylesheet" type="text/css" href="/static/common/layui/css/layui.css" media="all">
	<link rel="stylesheet" type="text/css" href="/static/common/bootstrap/css/bootstrap.css" media="all">
	<link rel="stylesheet" type="text/css" href="/static/common/global.css" media="all">
	<link rel="stylesheet" type="text/css" href="/static/css/personal.css" media="all">
</head>
<body>
<section class="layui-larry-box">
	<div class="larry-personal">
		<header class="larry-personal-tit">
			<span>添加评论</span>
		</header><!-- /header -->
		<div class="larry-personal-body clearfix">
			<form class="layui-form col-lg-5">
				<div class="layui-form-item">
					<label class="layui-form-label">文章id</label>
					<div class="layui-input-block">
						<input type="text" name="aid"  autocomplete="off" class="layui-input" value="{if !empty($mycomment.aid)}{$mycomment.aid}{/if}{if !empty($aid)}{$aid}{/if}"  placeholder="输入文章id">
						<input type="hidden" name="id" value="{if !empty($mycomment.id)}{$mycomment.id}{/if}" >
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label">评论人id</label>
					<div class="layui-input-block">
                                            <input type="text" name="userid"  autocomplete="off" class="layui-input" value="{if !empty($mycomment.userid)}{$mycomment.userid}{/if}" placeholder="输入评论人id">
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label">评论人姓名</label>
					<div class="layui-input-block">
                                            <input type="text" name="username"  autocomplete="off" class="layui-input" value="{if !empty($mycomment.username)}{$mycomment.username}{/if}" placeholder="输入发布人姓名">
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label">评论人头像</label>
					<div class="layui-input-block">
						<input type="file" name="file" class="layui-upload-file">
                                                <img style="width: 36px;height: 36px;" class="myimg" src="{php}if(!empty($mycomment['useravatar'])) echo imgUrl($mycomment['useravatar']);else echo imgUrl(''){/php}">
                                                <input type="text"  class="avatar layui-input-block" style="padding-left: 10px;width: 50%;margin-left: 10px;" name="useravatar" value="{if !empty($mycomment.useravatar)}{$mycomment.useravatar}{/if}" >
                                        </div>
                                </div>   
				<div class="layui-form-item">
					<label class="layui-form-label">评论内容</label>
					<div class="layui-input-block">
                                            <textarea name="comment" id="comment_html" placeholder="既然选择了远方，便只顾风雨兼程；路漫漫其修远兮，吾将上下而求索" value="" class="layui-textarea">{if !empty($mycomment.comment)}{$mycomment.comment}{/if}</textarea>
                                        </div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label">点赞数</label>
					<div class="layui-input-block">
                                            <input type="text" name="zan"  autocomplete="off" class="layui-input" value="{if !empty($mycomment.zan)}{$mycomment.zan}{/if}" placeholder="输入点赞数">
					</div>
				</div>     
                                <div class="layui-form-item">
					<label class="layui-form-label">是否发布</label>
					<div class="layui-input-block">
						<input type="radio" name="status" value="1" title="发布" {if !empty($mycomment.status)}{if $mycomment.status == 1}checked=""{/if}{else/}checked=""{/if}><div class="layui-unselect layui-form-radio layui-form-radioed"><i class="layui-anim layui-icon"></i><span>发布</span></div>
						<input type="radio" name="status" value="0" title="下架" {if !empty($mycomment.status)}{if $mycomment.status == 0}checked=""{/if}{/if}><div class="layui-unselect layui-form-radio"><i class="layui-anim layui-icon"></i><span>下架</span></div>
					</div>
				</div>
				
				
				<div class="layui-form-item">
					<div class="layui-input-block">
                                            <button type="button" class="layui-btn" onclick="comment_add()">立即提交</button>
						<button type="reset" class="layui-btn layui-btn-primary">重置</button>
					</div>
				</div>
			</form>
		</div>
	</div>
</section>
<script type="text/javascript" src="/static/common/layui/layui.js"></script>
<script type="text/javascript" src="/static/js/jquery.min.js"></script>
<script type="text/javascript">
        
	layui.use(['form','upload'],function(){
         layui.upload({ 
             url: '/server/fileupload.php',//上传接口 
             success: function(res){
                if(res.result){
                    $('.avatar').val(res.result);
                    $('.myimg').attr('src','/server/'+res.result);                    
                }else{
                    alert('上传失败');
                }
              console.log(res.result) 
            } 
         });

	});
function comment_add(){  //
    var aid=$("input[name='aid']").val();
    var id=$("input[name='id']").val();
    var userid=$("input[name='userid']").val();
    var username=$("input[name='username']").val();
    var useravatar=$("input[name='useravatar']").val();
    var comment=$("#comment_html").val();
    var zan=$("input[name='zan']").val();
    var status=$('input:radio[name="status"]:checked').val();
  
        $.ajax({
            type: 'POST',
            url: '/back/article/commentadd',
            data:{
              aid:aid,
              id:id,
              userid:userid,
              username:username,
              useravatar:useravatar,
              comment:comment,
              zan:zan,
              status:status,
            },
            success: function(data){
                 if(data.type==1){
                    layer.msg(data.msg);
                }else{
                    layer.msg(data.msg);
                }

            },
            error: function(xhr){
                layer.msg('error');
            }
        });
}   
</script>
</body>
</html>